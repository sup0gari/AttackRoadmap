#!/usr/bin/env python3
import sys

def xor(input, output, key):
    try:
        with open(input, "rb") as f:
            data = bytearray(f.read())

        key_len = len(key)
        for i in range(len(data)):
            data[i] ^= ord(key[i % key_len]) # xor

        with open(output, "wb") as f:
            f.write(data)

        print(f"[*] Success: {input} -> {output}")
        print(f"[*] Key used: {key}")
        print(f"[*] File size: {len(data)} bytes")

    except Exception as e:
        print(f"[!] Error: {e}")

if __name__ == "__main__":
    if len(sys.argv) < 4:
        print("Usage: python xor.py <input_file> <output_file> <xor_key>")
    else:
        xor(sys.argv[1], sys.argv[2], sys.argv[3])