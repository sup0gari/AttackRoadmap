# dropper

## 機能
- ドロッパー
- シェルコードのXOR暗号化
- 画像ファイルへのシェルコード埋め込み
- ドロッパー自身のメモリにシェルコードを展開して実行
- 自己消去

## 処理
1. シェルコードをXORで暗号化
2. 1で暗号化したシェルコードを画像ファイルに埋め込む
3. C2サーバーから動画ファイルをダウンロードして再生
4. C2サーバーから画像ファイルをダウンロードし、メモリに展開して実行
5. 実行後10秒で自己消去

## 実行までの手順
1. `dummy.mp4`, `dummy.jpg`を用意。
2. `donut.exe`(外部プログラム)で`malware.exe`を`malware.bin`(シェルコード)に変換。
```powershell
.\donut.exe -i malware.exe -o malware.bin
```
3. `xor.py`を実行し、`malware.bin`をXORで暗号化する。xor_keyを`dropper.c`にペースト
4. `steganography.py`を実行し、`dummy.jpg`に`malware.bin`を埋め込んだ`dummy_malware.jpg`を生成。signatureを`dropper.c`にペースト
5. `dummy.mp4`と`dummy_malware.jpg`を配置し、httpsサーバーを起動。
6. ターゲットで`dropper.exe`を実行する。
```powershell
cl.exe /O2 /MT dropper.c /link /SUBSYSTEM:WINDOWS /OUT:dropper.exe
```